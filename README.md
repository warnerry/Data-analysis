# ЛР5 — Классификация анемии (scikit-learn)

Лабораторная работа по машинному обучению: полный цикл анализа медицинского датасета и построение моделей **классификации** для предсказания целевого признака **`Анемия`** по показателям крови.

> Основной файл: **`ЛР5_Кольцов.ipynb`**

---

## Цель работы
- Практически изучить алгоритмы и методы **классификации**
- Провести предобработку данных, визуализацию и оценку качества моделей
- Сравнить несколько моделей и метрик качества
- Выполнить доп. задание: регрессия для предсказания ферритина

---

## Данные

Используется датасет `data.xlsx` со следующими признаками (пример):

- **UniqueCode** — уникальный идентификатор пациента/образца  
- **Возраст_дни** — возраст пациента в днях *(в ноутбуке дополнительно создаётся `Возраст_годы`)*  
- **Пол** — пол (в ноутбуке закодирован численно)  
- **WBC, RBC, HGB, HCT, MCV, MCH, MCHC, RDW-CV, RDW-SD, MicroR, MacroR** — показатели ОАК  
- **Железо в сыв.**, **Ферритин**, **СРБ** — биохимические показатели  
- **Анемия** — целевой столбец (класс 0/1)

⚠️ В ноутбуке есть момент утечки признаков: **ферритин** может слишком “подсказывать” целевую переменную, поэтому отдельно рассматривается сценарий **без `Ферритин`** (качество становится более реалистичным).

---

## Что сделано в ноутбуке

### 1) Предобработка и анализ
- загрузка данных из `.xlsx`
- обзор данных, описательная статистика
- проверка пропусков и дубликатов
- преобразование возраста: `Возраст_дни → Возраст_годы`
- удаление служебных колонок (например, `UniqueCode`, `Возраст_дни`)
- масштабирование числовых признаков (**StandardScaler**)

### 2) Визуализация
- pairplot/диаграммы рассеяния по классам
- матрицы ошибок (confusion matrix)
- ROC-кривые и AUC

### 3) Модели классификации
Сравниваются модели:
- **Logistic Regression**
- **K-Nearest Neighbors**
- **Decision Tree**
- **Random Forest**

Оценка по метрикам:
- Accuracy
- Precision / Recall
- F1-score
- Balanced Accuracy
- Confusion Matrix
- ROC AUC

### 4) Разбиение на подвыборки
Чтобы учесть различия по демографии, модели обучаются отдельно для 4 групп:
- Парни до 18
- Парни > 18
- Девушки до 18
- Девушки > 18

### 5) Дополнительное задание (регрессия)
- **RandomForestRegressor** для предсказания **`Ферритин`**
- качество по **MAE** и **R²**
- анализ важности признаков (feature importance) в разрезе групп

---

## Результаты (кратко)
- На полном датасете (с ферритином) качество может быть “слишком идеальным” → признак сильно влияет на разделение классов.
- После исключения `Ферритин` задача становится сложнее, и модели начинают опираться на типичные маркеры анемии (Hb, HCT, MCV/MCH, RDW, Micro/MacroR и др.).
- В большинстве экспериментов стабильно сильной моделью выступает **Random Forest** (хороший баланс метрик + интерпретируемость через важности признаков).

---

## Как запустить

### Jupyter Notebook
1. Склонируйте репозиторий:
   ```bash
   git clone <repo_url>
   cd <repo_name>
